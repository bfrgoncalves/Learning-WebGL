<!DOCTYPE html>
<html>
	<canvas id = 'c' width = '400' height = '400' style="border:1px solid #000000;"></canvas>
	<script src = 'webgl-utils.js'></script> <!-- USES THE UTILS DEFINED -->
	<script id = 'vshader' type = 'x-shader'>
		attribute vec2 position;
	    // attribute vec3 color;
	    attribute vec2 texcoord;
	    // varying vec3 Color;
	    varying vec2 Texcoord;
	    void main() {
	       // Color = color;
	       Texcoord = texcoord;
	       gl_Position = vec4(position, 0.0, 1.0);
	    }

	</script>
	<script id = 'fshader' type = 'x-shader'>
		precision mediump float;
		// varying vec3 Color;
	    varying vec2 Texcoord;

	    uniform sampler2D tex;
	    void main() {
	       gl_FragColor = texture2D(tex, Texcoord);
	    }
	
	</script>
	<script>

	// var vertices = [
 //    //  Position   Color             Texcoords
 //        -1.0,  1.0, 1.0, 0.0, 0.0, 0.0, 0.0, // Top-left
 //         1.0,  1.0, 0.0, 1.0, 0.0, 1.0, 0.0, // Top-right
 //         1.0, -1.0, 0.0, 0.0, 1.0, 1.0, 1.0, // Bottom-right
 //        -1.0, -1.0, 1.0, 1.0, 1.0, 0.0, 1.0  // Bottom-left
 //    ];

 	var vertices = [
    //  Position   Color             Texcoords
        -1.0,  1.0,  0.0, 0.0, // Top-left
         1.0,  1.0,  1.0, 0.0, // Top-right
         1.0, -1.0,  1.0, 1.0, // Bottom-right
        -1.0, -1.0,  0.0, 1.0  // Bottom-left
    ];

    var pixels = [
    0.0, 0.0, 0.0,   1.0, 1.0, 1.0,
    1.0, 1.0, 1.0,   0.0, 0.0, 0.0
	];

	var c = document.getElementById('c');
	var gl = c.getContext('experimental-webgl');

	//To create some geometry we need some BUFFER to hold some VERTEX data
	var vertexPosBuffer = gl.createBuffer();
	gl.bindBuffer(gl.ARRAY_BUFFER, vertexPosBuffer); //Bind buffer to the Bind point named ARRAY_BUFFER
	//var vertices = [-1, -1 , 1, -1, -1, 1 , 1, 1] //coordenates range from -1 to 1. So this will cover all the canvas
	gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW); //FLOAT32ARRAY is what we need to pass to the buffer. STATIC_DRAW means that we upload the data 
																				//once and draw it several times
	vertexPosBuffer.itemSize = 2; //Atributes for the buffer. SIze and number of items
	vertexPosBuffer.numItems = 4;
	vertexPosBuffer.numberOfParts = 2;
	/*
	 2___ 3 
	 |\  |		//Square is defined in this case as a triangle strip, two triangles combined
	 | \ | 
	0|__\|1
	*/

	//Define VERTEX SHADER and FRAGMENT SHADER
	vs = document.getElementById('vshader').textContent;
	fs = document.getElementById('fshader').textContent;

	console.log(vs);
	console.log(fs);


	var program = createProgram(vs,fs);
	gl.useProgram(program);
	program.vertexPosAttrib = gl.getAttribLocation(program,'position');
	// program.color = gl.getAttribLocation(program,'color');
	program.texcoord = gl.getAttribLocation(program,'texcoord');

	program.samplerUniform = gl.getUniformLocation(program,'uSampler'); //get the position of the texture sampler uniform
	gl.enableVertexAttribArray(program.vertexPosArray);
	gl.vertexAttribPointer(program.vertexPosAttrib, 2, gl.FLOAT, false , 0, 0); //Set the format of the IN data. 2 component, float and dont nedd to be normalized
	// gl.vertexAttribPointer(program.color, 3, gl.FLOAT, false , 0, 2);
	gl.vertexAttribPointer(program.texcoord, 2, gl.FLOAT, false , 0, 2);
	var texture = gl.createTexture();

	gl.bindTexture(gl.TEXTURE_2D, texture);
	gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGB, 2, 2, 0, gl.RGB, gl.FLOAT, new Float32Array(pixels));
	gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);
	gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);
	//gl.uniform1i(program.samplerUniform, 0); //passing the uniform value of texture unit 0;
	//gl.finish();
	gl.drawArrays(gl.TRIANGLE_STRIP, 0 , vertexPosBuffer.numItems); //Now takes 4 vertex instead of 3 like the triangle

	</script>


</html>